<html xmlns:py="http://genshi.edgewall.org/"
  xmlns:i18n="http://genshi.edgewall.org/i18n"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  xmlns:foaf="http://xmlns.com/foaf/0.1/"
  xmlns:owl="http://www.w3.org/2002/07/owl#"
  xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
  xmlns:dc="http://purl.org/dc/terms/"
  xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
  xmlns:dcat="http://www.w3.org/ns/dcat#"
  typeof="dcat:Dataset"
  about=""
  py:strip="">

  <py:def function="page_title">${c.pkg_dict.get('title', c.pkg_dict['name'])}
  - Datasets</py:def>

  <py:def function="page_heading" property="dc:title">
    ${c.pkg_dict['title']}
  </py:def>

  <py:match path="primarysidebar">

    <li py:if="c.pkg_dict.get('license_id')" id="dataset-license" class="sidebar-section">
      <strong>License:</strong>
        <py:choose test="">
          <span py:when="c.pkg_dict.get('license_url')"><a
              href="${c.pkg_dict.get('license_url')}" rel="dc:rights">${c.pkg_dict.get('license_title')}</a></span>
          <span py:when="c.pkg_dict.get('license_id')" property="dc:rights">${c.pkg_dict.get('license_title')}</span>
        </py:choose>
    </li>

    <li py:if="[tag for tag in c.pkg_dict.get('tags', []) if not tag.get('vocabulary_id')]" class="sidebar-section">
      <h3>Keywords</h3>
      ${tag_list(c.pkg_dict.get('tags', ''))}
    </li>

    <li py:if="c.pkg_dict.get('groups')" class="sidebar-section">
      <h3>Publisher</h3>
      <ul class="groups">
        <li py:for="group in sorted(c.pkg_dict.groups, key=lambda g: g['title'] or g['name'])">
        <a href="${h.url_for(controller='group', action='read', id=group['name'])}">${group.get('title') or group.get('name')}</a>
        </li>
      </ul>
    </li>

    <li py:if="c.package_relationships" class="sidebar-section">
      <h3>Related Datasets</h3>
      <ul class="related-datasets">
        <py:for each="pkg, relationship_str, comment in c.package_relationships">
          <li>
            ${h.literal(relationship_str % (h.link_to(pkg.name, h.url_for(controller="package", action="read", id=pkg.name))))}
            <span py:if="comment is not None and len(comment)" class="relationship_comment">
                (${comment})
            </span>
          </li>
        </py:for>
      </ul>
    </li>

  </py:match>

  <div py:match="content">
    <py:if test="c.pkg_revision_id">
      <div id="revision" class="widget-container">
        <p py:if="c.pkg_revision_not_latest">This is an old revision of this dataset, as edited <!--!by ${h.linked_user(rev.author)}-->at ${h.render_datetime(c.pkg_revision_timestamp, with_hours=True)}. It may differ significantly from the <a href="${h.url(controller='package', action='read', id=c.pkg.name)}">current revision</a>.</p>
        <p py:if="not c.pkg_revision_not_latest">This is the current revision of this dataset, as edited <!--!by ${h.linked_user(rev.author)}-->at ${h.render_datetime(c.pkg_revision_timestamp, with_hours=True)}.</p>
      </div>
    </py:if>

    <xi:include href="read_core.html" />

    <span class="insert-comment-thread"></span>
  </div>

  <py:def function="optional_head">
    <py:if test="config.get('rdf_packages')">
      <link rel="alternate" type="application/rdf+xml" title="RDF/XML" href="${h.url(controller='package', action='read', id=c.pkg.name) + '.rdf'}" />
      <link rel="alternate" type="application/turtle" title="RDF/N3" href="${h.url(controller='package', action='read', id=c.pkg.name) + '.n3'}" />
    </py:if>
  </py:def>

  <py:def function="optional_feed">
  <link rel="alternate" type="application/atom+xml" title="Dataset History"
    href="${h.url(controller='package', action='history', id=c.pkg.name, format='atom', days=7)}" />
  </py:def>

  <xi:include href="layout.html" />
</html>

